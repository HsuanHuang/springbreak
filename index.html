<html>
<head>
<title>Spring Break</title>
<link href="https://fonts.googleapis.com/css?family=Alegreya|Alegreya+Sans" rel="stylesheet">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://d3js.org/topojson.v2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<style>
body { font-family: 'Futura', Calibri, sans-serif; }
svg { border: solid #ccc 1px; }
</style>
</head>
<body>

<center>

<h2>Your Spring Break Destination</h2>
<p>Flight Prices And Hours From JFK</p>


<svg height="800" width="800">
</svg>
</center>

<script>

var svg = d3.select("svg");

//The center point
svg.append("circle")
.attr("id", "center")
.attr("cx", 400)
.attr("cy", 400)
.attr("r", 20)
.style("fill", "#FFC200");



var flightData;



var degree;

// Converts from degrees to radians.
Math.radians = function(degrees) {
  return degrees * Math.PI / 180;
};

// Converts from radians to degrees.
Math.degrees = function(radians) {
  return radians * 180 / Math.PI;
};

var centerLat = Math.radians(39.8282);
var centerLong = Math.radians(-98.5795);



d3.csv("flightData.csv", function (error, data) {

		flightData = data;
		//console.log(flightData);

		

		var priceScale = d3.scaleLinear()
						.domain([117, 1104])
						.range([50, 400]);

		var hourScale = d3.scaleLinear()
						.domain([0, 40])
						.range([0,1]);

		flightData.forEach(function(d) {


			var lon = Math.radians( d.Long );
			
			var lat = Math.radians( d.Lat );

			var y = Math.sin(lon - centerLong)* Math.cos(lat);
			var x = Math.cos( centerLat )* Math.sin(lat) - Math.sin(centerLat)* Math.cos(lat)* Math.cos(lon - centerLong);
			var bearing =  Math.atan2(y, x) ;

			console.log(bearing + d.City);

			var r = priceScale(d.Price);
			//console.log(r);

			var cx = 400 + r * Math.sin(bearing);
			var cy = 400 + r * Math.cos(bearing)*(-1);

			svg.append("circle")
			.attr("cx", cx)
			.attr("cy", cy)
			.attr("r", 5)
			.style("opacity", hourScale(d.FlightHour))

			svg.append("text")
			.text(d.City)
			.attr("x", cx+5)
			.attr("y", cy+5)
            .attr("font-family", "Futura")
            .attr("font-size", "10px")
            .attr("fill", "gray");

		 });
});
	




</script>




</body>
</html>
