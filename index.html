<html>
    <head>
        <title>Spring Break</title>
        <link href="https://fonts.googleapis.com/css?family=Alegreya|Alegreya+Sans" rel="stylesheet">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="http://d3js.org/topojson.v2.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.21.0/d3-legend.js"></script>
        <style>
            body { font-family: 'Futura', Calibri, sans-serif; }
        </style>
    </head>
    
    
    <body>

        <center>

            <h2>Your Spring Break Destination</h2>
            <p>Flight Prices And Hours From JFK</p>


            <svg height="2400" width="800">
            </svg>
        </center>

        <script>

            var svg = d3.select("svg");

            // Small Price Scale
            var smallPriceScale = d3.scaleLinear()
				.domain([0, 300])
				.range([0, 300]);
            
            // Large Price Scale
            var largePriceScale = d3.scaleLinear()
				.domain([0, 1100])
				.range([0, 400]);
            
            
            var hourScale = d3.scaleLinear()
				.domain([0,1,2,3,4,6,8,10,15,20,30,40])
				.range([
                    //Blue Scale
					'#00008b',
                    '#3e3e9f',
					'#6a6db2',
                    '#d7dcd6',
                    //Yellow Scale
					'#ffffbf',
					'#fee090',
					'#fdae61',
					'#f46d43',
                    //Red Scale
					'#d73141',     
					'#c11853',
                    '#a50067',                    
                    '#800080']);


            
            
            
            //TOP GRAPH
            
            //Top Center Point
            svg.append("circle")
                .attr("id", "center")
                .attr("cx", 400)
                .attr("cy", 1200)
                .attr("r", 15)
                //.style("fill", "#FFC200");
                .style("fill", "gray");          
            
            var small_prices = [100,200,300]
            
            small_prices.forEach(function(d){
                svg.append("circle")
                    .attr("cx", 400)
                    .attr("cy", 1200)
                    .attr("r", smallPriceScale(d) )
                    .style("fill", "none")
                    .attr("stroke-width", 0.5)
                    .attr("stroke", "gray") ;
            })
            
            
            var region_op = 0.35;
            
            
            //Bottom Quadrants
            
            var region_divisions = [
                ["#b3cde3",0.37*Math.PI,0.5*Math.PI],
                ["#ccebc5",0.5*Math.PI,0.75*Math.PI],
                ["#fbb4ae",0.75*Math.PI,1.25*Math.PI],
                ["#fed9a6",1.25*Math.PI,1.71*Math.PI],
                ["#46add4",1.71*Math.PI,2.37*Math.PI]]
            
            region_divisions.forEach(function(d){
                var arc = d3.arc()
                            .innerRadius(0)
                            .outerRadius(300)
                            .startAngle(d[1])
                            .endAngle(d[2]);
                
                svg.append("path")
                   .attr("d", arc)
                   .style("fill", d[0])
                   .style("opacity", region_op)
                   .attr("transform", "translate(400,1200)");    
            })
            
            
            
            //Top Quadrants
            
            region_divisions.forEach(function(d){
                var arc = d3.arc()
                            .innerRadius(0)
                            .outerRadius(400)
                            .startAngle(d[1])
                            .endAngle(d[2]);
                
                svg.append("path")
                   .attr("d", arc)
                   .style("fill", d[0])
                   .style("opacity", region_op)
                   .attr("transform", "translate(400,400)");    
            })
            
            
            
            //BOTTOM GRAPH
            
            //Bottom center circle    
            svg.append("circle")
                .attr("id", "center")
                .attr("cx", 400)
                .attr("cy", 400)
                .attr("r", largePriceScale(300))
                .style("fill", "gray")
                .style("opacity", 0.65); 
            
            var large_prices = [500,700,900,1100]
            
            large_prices.forEach(function(d){
                svg.append("circle")
                    .attr("cx", 400)
                    .attr("cy", 400)
                    .attr("r", largePriceScale(d) )
                    .style("fill", "none")
                    .attr("stroke-width", 0.5)
                    .attr("stroke", "gray") ;
            })
                
            
            
            
            
            
            //Lines to show scale
            svg.append("line")
			.attr("x1", 400+smallPriceScale(300)-4)
			.attr("y1", 1150)
			.attr("x2", 400+largePriceScale(300))
			.attr("y2", 400)
            .style("stroke", "gray")
            .style("stroke-dasharray", "5,5");
            
            svg.append("line")
			.attr("x1", 400-smallPriceScale(300)+4)
			.attr("y1", 1150)
			.attr("x2", 400-largePriceScale(300))
			.attr("y2", 400)
            .style("stroke", "gray")
            .style("stroke-dasharray", "5,5");
            
            
            // Legends
            
            //Flight Time
            //svg.append("g")
            //    .attr("class", "legendFlightTime")
            //    .attr("transform", "translate(100,400)")
            //    .style("font-size", "10px");
            
            //var legendFlightTime = d3.legendColor()
            //    .shape('circle')
            //    .shapeWidth(20)
            //    .shapeHeight(20)
            //    .shapePadding(10)
            //    .scale(hourScale);
            
            //svg.select(".legendFlightTime")
            //.call(legendFlightTime);
                
            
            
            
            //Region
            
            
            
            
            //FUNCTIONS
            var flightData;

            var degree;

            // Converts from degrees to radians.
            Math.radians = function(degrees) {
                return degrees * Math.PI / 180;
            };

            // Converts from radians to degrees.
            Math.degrees = function(radians) {
                return radians * 180 / Math.PI;
            };

            var centerLat = Math.radians(39.8282);
            var centerLong = Math.radians(-98.5795);

            var Int_Apo = ["BOS","PHL","ORD","ATL","MIA","MCO","DFW","HOU","DEN","JAC","LAS","PHX","SEA","SFO","LAX","HNL","PUJ","RSD","PVR","CUN"]

            
            
            
            d3.csv("flightData.csv", function (error, data) {

		      flightData = data;
		      //console.log(flightData);

		


		      flightData.forEach(function(d) {


			     var lon = Math.radians( d.Long );
			
			     var lat = Math.radians( d.Lat );

			     var y = Math.sin(lon - centerLong)* Math.cos(lat);
			     var x = Math.cos( centerLat )* Math.sin(lat) - Math.sin(centerLat)* Math.cos(lat)* Math.cos(lon - centerLong);
			     var bearing =  Math.atan2(y, x) ;

			     //console.log(bearing + d.City);
			     //console.log(d.Hour);

			     var r_top = largePriceScale(d.Price);
                 var r_bot = smallPriceScale(d.Price);

			     var cx_top = 400 + r_top * Math.sin(bearing);
			     var cy_top = 400 + r_top * Math.cos(bearing)*(-1);
                  
			     var cx_bot = 400 + r_bot * Math.sin(bearing);
			     var cy_bot = 1200 + r_bot * Math.cos(bearing)*(-1);

                 // Top Plot

                  
                 if (d.Price > 300) { 
                     svg.append("circle")
			         .attr("cx", cx_top)
			         .attr("cy", cy_top)
			         .attr("r", 4)
			         .attr("fill", hourScale(d.Hour) );
                     
                     svg.append("text")
			         .text(d.Airport)
			         .attr("x", cx_top+5)
			         .attr("y", cy_top+6)
                     .attr("font-family", "Futura")
                     .attr("font-size", "10px")
                     //.attr("text-anchor", "middle")
                     //.attr("alignment-baseline", "central")
                     .attr("fill", "gray");
                 }
                     
                 // Bottom Plot
                 if (d.Price <= 300){
                     svg.append("circle")
			         .attr("cx", cx_bot)
			         .attr("cy", cy_bot)
			         .attr("r", 4)
			         .attr("fill", hourScale(d.Hour) );
                     
                     svg.append("text")
			         .text(d.Airport)
			         .attr("x", cx_bot+5)
			         .attr("y", cy_bot+6)
                     .attr("font-family", "Futura")
                     .attr("font-size", "10px")
                     //.attr("text-anchor", "middle")
                     //.attr("alignment-baseline", "central")
                     .attr("fill", "gray");
                     
                     
                     svg.append("circle")
			         .attr("cx", cx_top)
			         .attr("cy", cy_top)
			         .attr("r", 3)
			         .attr("fill", hourScale(d.Hour) )
                     .style("opacity", 0.4);
                 }


                 //if (Int_Apo.indexOf(d.Airport) >= 0){
			       //  svg.append("text")
			     //    .text(d.Airport)
			     //    .attr("x", cx_bot+5)
			     //    .attr("y", cy_bot+6)
                //     .attr("font-family", "Futura")
                  //   .attr("font-size", "10px")
                   //.attr("text-anchor", "middle")
                //     .attr("alignment-baseline", "central")
                //     .attr("fill", "gray");
                
                //     svg.append("line")
			     //    .attr("x1", cx_bot)
			     //    .attr("y1", cy_bot)
			     //    .attr("x2", cx_bot+5)
			     //    .attr("y2", cy_bot+4)
                //     .style("stroke", "gray");
                //}
		      });
            });
	




        </script>
    </body>
    
    
    
    
</html>
